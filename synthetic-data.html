<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src = "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.8.0"></script>
</head>
<body>
  <script>
    // 生成 y = a x^3 + b x^2 + c x + d 的曲线
    // 1.设置变量
    const a = tf.variable(tf.scalar(Math.random()));
    const b = tf.variable(tf.scalar(Math.random()));
    const c = tf.variable(tf.scalar(Math.random()));
    const d = tf.variable(tf.scalar(Math.random()));
  
    // 2. 建立模型
    function predict(x){
      return tf.tidy(() => {
        return a.mul(x.pow(tf.scalar(3)))
          .add(b.mul(x.square()))
          .add(c.mul(x))
          .add(d)
      })
    }

    // 3.训练模型
      // 1.定义损失 loss
      function loss(predictions, labels){
        const meanSquareError = predictions.sub(labels).square().mean()
        return meanSquareError;
      }

      // 2.定义优化器 optimizer 和 学习率 learningRute
      // const learningRute = 0.5
      // const optimizer = tf.train.sgd(learningRute);
      
      // 3. 定义训练循环
      function  train (xs, ys, numIterations = 75) {
        const learningRute = 0.5;
        const optimizer = tf.train.sgd(learningRute)

        for( let i = 0; i < numIterations; i++){
          optimizer.minimize(() => {
            const predsYs = predict(xs);
            console.log(predsYs)
            console.log(meanSquareError)
            return loss(predsYs, ys)
          })
        }
      }


      //设置变量
      //创建模型
      // 训练模型： 1. 定义损失  2. 定义优化器 学习率  3. 定义训练循环
      
      

  
  </script>
  
</body>
</html>